<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sonicscrewdriver">
<title>Managing audio in R â€¢ sonicscrewdriver</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Managing audio in R">
<meta property="og:description" content="sonicscrewdriver">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sonicscrewdriver</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sonicscrewdriver.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/audioblast.html">Using audioBlast with R</a>
    <a class="dropdown-item" href="../articles/augment-audio-data.html">Augmenting audio data in R with SonicScrewdriveR</a>
    <a class="dropdown-item" href="../articles/converting-code.html">Converting code to work with SonicScrewdriveR</a>
    <a class="dropdown-item" href="../articles/manage_audio.html">Managing audio in R</a>
    <a class="dropdown-item" href="../articles/other-apps.html">Interacting with other tools</a>
    <a class="dropdown-item" href="../articles/test-signals.html">Generating test signals</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/edwbaker/SonicScrewdriveR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Managing audio in R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/edwbaker/SonicScrewdriveR/blob/HEAD/vignettes/manage_audio.Rmd" class="external-link"><code>vignettes/manage_audio.Rmd</code></a></small>
      <div class="d-none name"><code>manage_audio.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sonicscrewdriver.ebaker.me.uk" class="external-link">sonicscrewdriver</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="managing-audio-in-r-with-sonicscrewdriver">Managing audio in R with SonicScrewdriveR<a class="anchor" aria-label="anchor" href="#managing-audio-in-r-with-sonicscrewdriver"></a>
</h2>
<div class="section level3">
<h3 id="reading-audio-files">Reading audio files<a class="anchor" aria-label="anchor" href="#reading-audio-files"></a>
</h3>
<p>Several functions are available to read audio files into R, including
the <code>readWave()</code> and <code>readMP3()</code> functions from
the <code>tuneR</code> package, as well as tools from the package
<code>av</code>. SonicScrewdriveR simplifies reading audio files by
providing a single wrapper for these functions,
<code><a href="../reference/readAudio.html">readAudio()</a></code>, which can read audio files in a variety of
formats, including WAV, MP3, and FLAC.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"AUDIOMOTH.WAV"</span>, package<span class="op">=</span><span class="st">"sonicscrewdriver"</span><span class="op">)</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readAudio.html">readAudio</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="performing-analyses-on-channels">Performing analyses on channels<a class="anchor" aria-label="anchor" href="#performing-analyses-on-channels"></a>
</h3>
<p>Some existing functions only operate on a single channel at a time.
This may cause unnecessarily complex workflows when bulk analysing files
with different numbers of channels. The <code><a href="../reference/allChannels.html">allChannels()</a></code>
function applies a function to each channel and returns a list of
analyses. This technique allows for the same analysis to be performed on
each channel, without reference to the number of channels in the audio
file. Optionally, a cluster can be specified to process channels on
separate processor cores to increase analysis speed.</p>
</div>
<div class="section level3">
<h3 id="windowing">Windowing<a class="anchor" aria-label="anchor" href="#windowing"></a>
</h3>
<p>It is often desirable to process a long audio file in chunks. The
<code><a href="../reference/windowing.html">windowing()</a></code> function can be used to split an audio file
into overlapping or non-overlapping windows. This function may be
particularly useful for processing long Wave files in a memory-efficient
manner. Optionally, a cluster can be specified to process windows on
separate processor cores to increase processing speed.</p>
<p>In order to demonstrate <code><a href="../reference/windowing.html">windowing()</a></code> we first define a
simple function that draws a rectangle around the windowed region of a
sound file.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drawWindow</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span> <span class="va">wave</span>, <span class="va">start</span>, <span class="va">window.length</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="va">start</span>, <span class="op">-</span><span class="fl">1</span>, <span class="va">start</span><span class="op">+</span><span class="va">window.length</span>, <span class="fl">1</span>, col<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1.0</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We can then show the windows generated if the
<code>window.length</code> is 44100 samples, and the
<code>window.overlap</code> is 0.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a 5 second sine wave of 1Hz</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">tuneR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/Waveforms.html" class="external-link">sine</a></span><span class="op">(</span><span class="fl">1</span>, duration<span class="op">=</span><span class="fl">5</span><span class="op">*</span><span class="fl">44100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">w</span><span class="op">@</span><span class="va">left</span>, type<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"Time (samples)"</span>, ylab<span class="op">=</span><span class="st">"Amplitude"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/windowing.html">windowing</a></span><span class="op">(</span><span class="va">w</span>, window.length<span class="op">=</span><span class="fl">44100</span>, window.overlap <span class="op">=</span> <span class="fl">0</span>, FUN<span class="op">=</span><span class="va">drawWindow</span><span class="op">)</span></span></code></pre></div>
<p><img src="manage_audio_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>The entire audio file is analysed in chunks of 44100 samples, with no
overlap between windows. The <code>drawWindow()</code> function is
applied to each window, and the result is plotted on top of the
oscillogram of the original audio file.</p>
<p>The <code>window.overlap</code> parameter can be adjusted so that the
windows overlap by a certain number of samples.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">w</span><span class="op">@</span><span class="va">left</span>, type<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"Time (samples)"</span>, ylab<span class="op">=</span><span class="st">"Amplitude"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/windowing.html">windowing</a></span><span class="op">(</span><span class="va">w</span>, window.length<span class="op">=</span><span class="fl">44100</span>, window.overlap <span class="op">=</span> <span class="fl">44100</span><span class="op">/</span><span class="fl">2</span>, FUN<span class="op">=</span><span class="va">drawWindow</span><span class="op">)</span></span></code></pre></div>
<p><img src="manage_audio_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Alternatively, a negative value of <code>window.overlap</code> can be
used to take regularly-spaced samples from the audio file.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">w</span><span class="op">@</span><span class="va">left</span>, type<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"Time (samples)"</span>, ylab<span class="op">=</span><span class="st">"Amplitude"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/windowing.html">windowing</a></span><span class="op">(</span><span class="va">w</span>, window.length<span class="op">=</span><span class="fl">44100</span>, window.overlap <span class="op">=</span> <span class="op">-</span><span class="fl">44100</span>, FUN<span class="op">=</span><span class="va">drawWindow</span><span class="op">)</span></span></code></pre></div>
<p><img src="manage_audio_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The <code>bind.wave</code> parameter can be used to combine the
results of the windowing function into a single Wave object (if FUN
returns a Wave object).</p>
<p>In the example below we use <code><a href="../reference/windowing.html">windowing()</a></code> to add noise to
sections of a sine wave.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">tuneR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/Waveforms.html" class="external-link">sine</a></span><span class="op">(</span><span class="fl">1</span>, duration<span class="op">=</span><span class="fl">5</span><span class="op">*</span><span class="fl">44100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">addNoise</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span>, <span class="va">start</span>, <span class="va">window.length</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">nw</span> <span class="op">&lt;-</span> <span class="fu">tuneR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/Waveforms.html" class="external-link">noise</a></span><span class="op">(</span><span class="st">"white"</span>, duration<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">w</span><span class="op">@</span><span class="va">left</span><span class="op">)</span>, samp.rate<span class="op">=</span><span class="va">w</span><span class="op">@</span><span class="va">samp.rate</span>, pcm<span class="op">=</span><span class="va">w</span><span class="op">@</span><span class="va">pcm</span>, bit<span class="op">=</span><span class="va">w</span><span class="op">@</span><span class="va">bit</span><span class="op">)</span></span>
<span>  <span class="va">rw</span> <span class="op">&lt;-</span> <span class="va">w</span> <span class="op">+</span> <span class="va">nw</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">nw</span><span class="op">@</span><span class="va">left</span><span class="op">)</span> <span class="co"># Scale noise to the amplitude of the sine wave</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">rw</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/windowing.html">windowing</a></span><span class="op">(</span><span class="va">w</span>, window.length<span class="op">=</span><span class="fl">44100</span>, window.overlap <span class="op">=</span> <span class="op">-</span><span class="fl">44100</span>, FUN<span class="op">=</span><span class="va">addNoise</span>, bind.wave<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">o</span><span class="op">@</span><span class="va">left</span>, type<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"Time (samples)"</span>, ylab<span class="op">=</span><span class="st">"Amplitude"</span><span class="op">)</span></span></code></pre></div>
<p><img src="manage_audio_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="pseudowave-objects">PseudoWave objects<a class="anchor" aria-label="anchor" href="#pseudowave-objects"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="taggedwave-workflow">TaggedWave workflow<a class="anchor" aria-label="anchor" href="#taggedwave-workflow"></a>
</h2>
<p>The techniques above can be applied to the generic <code>Wave</code>
and <code>WaveMC</code> objects from the <code>tuneR</code> package.</p>
<p>The <code>TaggedWave</code> class extends the <code>Wave</code> class
from the <code>tuneR</code> package so that it can include extended
metadata and the results of analyses. This allows for the storage of
additional information about the audio file, such as the location and
time of recording, and the results of analyses. The
<code><a href="../reference/tagWave.html">tagWave()</a></code> function can be used to tag a <code>Wave</code>
or <code>WaveMC</code> object with additional metadata.</p>
<p>In addition, combined with new classes <code>WaveAugment</code>,
<code>WaveFilter</code>, and <code>WaveAnalyse</code> it is possible to
create a self-documenting pipeline for audio processing and analysis
(that is also compatible with the R pipe).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://ebaker.me.uk" class="external-link">Ed Baker</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
